@page "/login"
@rendermode InteractiveServer
@using BlazorApp.Auth
@using Microsoft.AspNetCore.Components.Authorization
@inject NavigationManager Navigation
@inject AuthenticationStateProvider AuthStateProvider

<h3>Login</h3>

@code 
{
	private string userName;
	private string password;
	private string errorMessage;

	private async Task LoginAsync()
	{
		errorMessage = string.Empty;
		try
		{
			await ((SimpleAuthProvider)AuthStateProvider).LoginAsync(userName, password);
		}
		catch (Exception ex)
		{ 
			Console.WriteLine(ex.Message);
			errorMessage = $"Login failed: {ex.Message}";
		}
	}
}


<AuthorizeView>
	<NotAuthorized>
		<h3>Please login</h3>
		<label>User name:</label>
		<input type="te" @bind="userName" />
		<label>Password:</label>
		<input type="password" @bind="password" />
		@if (!string.IsNullOrEmpty(errorMessage))
		{
			<label style="color: red">
				@errorMessage
			</label>
		}
		<button @onclick="LoginAsync">Log in</button>
	</NotAuthorized>
	<Authorized>
		<h3>Hello, @context.User.Identity!.Name</h3>
	</Authorized>


</AuthorizeView>